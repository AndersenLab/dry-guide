<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>WI-Concordance - Andersen Lab Dry Guide</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "WI-Concordance";
    var mkdocs_page_input_path = "pipeline-concordance.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Andersen Lab Dry Guide</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../bash/">Bash</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Quest</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../quest-intro/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../quest-andersen-lab-env/">Andersen-Lab-Env</a>
                </li>
                <li class="">
                    
    <a class="" href="../quest-nextflow/">Nextflow</a>
                </li>
                <li class="">
                    
    <a class="" href="../quest-mount/">Mounting Quest</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Pipelines</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../pipeline-overview/">Overview</a>
                </li>
                <li class="">
                    
    <a class="" href="../adding-seq-data/">Adding NILs Sequencing Data</a>
                </li>
                <li class="">
                    
    <a class="" href="../sample-sheets/">Sample Sheets</a>
                </li>
                <li class="">
                    
    <a class="" href="../pipeline-GCPconfig/">GCP configuration</a>
                </li>
                <li class="">
                    
    <a class="" href="../pipeline-docker/">Build docker iamge</a>
                </li>
                <li class="">
                    
    <a class="" href="../pipeline-trimming/">Trimming</a>
                </li>
                <li class="">
                    
    <a class="" href="../pipeline-nil-ril/">NIL / RIL</a>
                </li>
                <li class="">
                    
    <a class="" href="../pipeline-alignment/">WI-Alignment</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">WI-Concordance</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#concordance-nf">concordance-nf</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#usage">Usage</a></li>
        
            <li><a class="toctree-l4" href="#overview">Overview</a></li>
        
            <li><a class="toctree-l4" href="#usage_1">Usage</a></li>
        
        </ul>
    

    <li class="toctree-l3"><a href="#parameters">Parameters</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#--cores">--cores</a></li>
        
            <li><a class="toctree-l4" href="#--out">--out</a></li>
        
            <li><a class="toctree-l4" href="#--sample_sheet">--sample_sheet</a></li>
        
            <li><a class="toctree-l4" href="#--fq_prefix">--fq_prefix</a></li>
        
            <li><a class="toctree-l4" href="#--reference">--reference</a></li>
        
            <li><a class="toctree-l4" href="#--tmpdir">--tmpdir</a></li>
        
            <li><a class="toctree-l4" href="#--bamdir">--bamdir</a></li>
        
            <li><a class="toctree-l4" href="#--email">--email</a></li>
        
        </ul>
    

    <li class="toctree-l3"><a href="#output">Output</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#concordance">Concordance/</a></li>
        
            <li><a class="toctree-l4" href="#duplicates">Duplicates/</a></li>
        
            <li><a class="toctree-l4" href="#fq">fq/</a></li>
        
            <li><a class="toctree-l4" href="#strain">strain/</a></li>
        
            <li><a class="toctree-l4" href="#variation">variation/</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../pipeline-wi/">WI</a>
                </li>
                <li class="">
                    
    <a class="" href="../pipeline-cegwas/">Cegwas</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../cendr/">CeNDR</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../r/">R</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../backup/">Backup</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../cloud/">Cloud</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../labsite/">Andersen Labsite</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Andersen Lab Dry Guide</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Pipelines &raquo;</li>
        
      
    
    <li>WI-Concordance</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/Andersenlab/dry-guide/edit/master/docs/pipeline-concordance.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="concordance-nf">concordance-nf<a class="headerlink" href="#concordance-nf" title="Permanent link">&para;</a></h1>
<p>The <code>concordance-nf</code> pipeline...</p>
<div class="toc">
<ul>
<li><a href="#concordance-nf">concordance-nf</a><ul>
<li><a href="#usage">Usage</a></li>
<li><a href="#overview">Overview</a></li>
<li><a href="#usage_1">Usage</a><ul>
<li><a href="#debugging_the_pipeline_locally">Debugging the pipeline locally</a></li>
<li><a href="#debugging_the_pipeline_on_quest">Debugging the pipeline on Quest</a></li>
<li><a href="#running_the_pipeline_on_quest">Running the pipeline on Quest</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#parameters">Parameters</a><ul>
<li><a href="#--cores">--cores</a></li>
<li><a href="#--out">--out</a></li>
<li><a href="#--sample_sheet">--sample_sheet</a></li>
<li><a href="#--fq_prefix">--fq_prefix</a></li>
<li><a href="#--reference">--reference</a></li>
<li><a href="#--tmpdir">--tmpdir</a></li>
<li><a href="#--bamdir">--bamdir</a></li>
<li><a href="#--email">--email</a></li>
</ul>
</li>
<li><a href="#output">Output</a><ul>
<li><a href="#concordance">Concordance/</a><ul>
<li><a href="#concordancepng">concordance.png</a></li>
<li><a href="#concordance_above_99png">concordance_above_99.png</a></li>
<li><a href="#isotype_groupstsv">isotype_groups.tsv</a></li>
<li><a href="#gtcheck">gtcheck</a></li>
<li><a href="#isotype_counttxt">isotype_count.txt</a></li>
<li><a href="#heterozygosity">Heterozygosity</a></li>
<li><a href="#fq_concordancetsv">fq_concordance.tsv</a></li>
<li><a href="#concordancepairwise_directory">concordance/pairwise/ (directory)</a></li>
</ul>
</li>
<li><a href="#duplicates">Duplicates/</a><ul>
<li><a href="#bam_duplicatestsv">bam_duplicates.tsv</a></li>
</ul>
</li>
<li><a href="#fq">fq/</a></li>
<li><a href="#strain">strain/</a></li>
<li><a href="#variation">variation/</a><ul>
<li><a href="#sitelisttsvgztbi">sitelist.tsv.gz(+tbi)</a></li>
<li><a href="#union_vcftxt">union_vcf.txt</a></li>
<li><a href="#mergedrawvcfgzcsi">merged.raw.vcf.gz(+csi)</a></li>
<li><a href="#concordancevcfgzcsi">concordance.vcf.gz(+csi)</a></li>
<li><a href="#concordancestats">concordance.stats</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<h2 id="usage">Usage<a class="headerlink" href="#usage" title="Permanent link">&para;</a></h2>
<pre><code>
    ┌─┐┌─┐┌┐┌┌─┐┌─┐┬─┐┌┬┐┌─┐┌┐┌┌─┐┌─┐  ┌┐┌┌─┐
    │  │ │││││  │ │├┬┘ ││├─┤││││  ├┤───│││├┤ 
    └─┘└─┘┘└┘└─┘└─┘┴└──┴┘┴ ┴┘└┘└─┘└─┘  ┘└┘└  

    parameters              description                    Set/Default
    ==========              ===========                    =======

    --debug                 Set to 'true' to test          false
    --cores                 Regular job cores              4
    --out                   Directory to output results    concordance-&lt;todays date&gt;
    --sample_sheet          fastq file (see help)          sample_sheet.tsv
    --fq_prefix             fastq file (see help)          null
    --reference             Reference Genome               WS245/WS245.fa.gz
    --bamdir                Location for bams              bam
    --tmpdir                A temporary directory          tmp/
    --email                 Email to be sent results

    HELP: http://andersenlab.org/dry-guide/pipeline-concordance/

</code></pre>

<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p><img alt="concordance-pipeline" src="../img/concordance-pipeline.svg" /></p>
<p>The concordance pipeline is used to detect sample swaps, identify samples with quality issues, and determine which wild isolate strains should be grouped together as an isotype. When performing sequencing, we often sequence the same DNA library or strain multiple times in order to attain adequate coverage. To ensure that samples are labeled properly we examine whether they contain discordant variant calls based on what strain they are labeled as. </p>
<p>The <code>concordance-nf</code> pipeline will proceed to group FASTQs labeled as a strain regardless of the quality of the data. Therefore, if issues are suspected the problemetic data needs to be removed and the pipeline rerun. More details are available below.</p>
<p>To determine which strains belong to the same isotype we use two criteria. First we look at the strains that group together with a concordance threshold of 99.9%. Generally this will group most isotypes without issue. However, it is possible that you will run into cases where the grouping is not clean. For example, strain A groups with B, B groups with C, but C does not group with A. In these cases you must examine the data closely to identify why strains are incompletely grouping. Our second criteria we use to group isotypes may address these types of groupings.</p>
<p>The second criteria that we use to group isotypes regards looking for regional differences among strains. If two strains are similar but possess a region of their genome (binned at 1 Mb) that differs by more than 2% then we will separate them out into their own isotypes.</p>
<p><strong>The process of grouping isotypes is very hand-on. This pipeline will help process the data but you must carefully review the output and investigate closely.</strong></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is at least one exception to the 99.9% cutoff rule we use to determine isotypes.</p>
<p>We classify LSJ1 and N2 as separate isotypes despite the fact that they are greater than 99.9% identical. The strains are known to have diverged from one another, but work has demonstrated significant
genetic and phenotypic differences.</p>
</div>
<h2 id="usage_1">Usage<a class="headerlink" href="#usage_1" title="Permanent link">&para;</a></h2>
<p>The <code>nextflow.config</code> file sets most of the defaults you need to get the pipeline running locally for debugging purposes or on Quest.</p>
<h3 id="debugging_the_pipeline_locally">Debugging the pipeline locally<a class="headerlink" href="#debugging_the_pipeline_locally" title="Permanent link">&para;</a></h3>
<p>The pipeline comes with a test dataset that you can use to make changes or fix problems. When running locally, you should install the <a href="../quest-andersen-lab-env/">andersen-lab-env</a> which will install all the required dependencies.</p>
<p><strong>Fetching the reference</strong></p>
<p>You will need a reference genome to align to. You can fetch one by running the following command:</p>
<pre><code>curl https://storage.googleapis.com/elegansvariation.org/genome/WS245/WS245.tar.gz &gt; WS245.tar.gz
tar -xvzf WS245.tar.gz
</code></pre>

<p>Run the pipeline locally by setting <code>-profile debug</code>:</p>
<pre><code>nextflow run main.nf -profile debug -resume
</code></pre>

<h3 id="debugging_the_pipeline_on_quest">Debugging the pipeline on Quest<a class="headerlink" href="#debugging_the_pipeline_on_quest" title="Permanent link">&para;</a></h3>
<p>When running on Quest, you should first run the quest debug profile. The Quest debug profile will use the test dataset and sample sheet which runs much faster and will encounter errors much sooner should they need to be fixed. If the debug dataset runs to completion it is likely that the full dataset will as well.</p>
<pre><code>nextflow run main.nf -profile quest_debug -resume --email &lt;your email&gt;
</code></pre>

<h3 id="running_the_pipeline_on_quest">Running the pipeline on Quest<a class="headerlink" href="#running_the_pipeline_on_quest" title="Permanent link">&para;</a></h3>
<p>The pipeline can be run on Quest using the following command:</p>
<pre><code>nextflow run main.nf -profile quest -resume --email &lt;your email&gt;
</code></pre>

<h1 id="parameters">Parameters<a class="headerlink" href="#parameters" title="Permanent link">&para;</a></h1>
<p>The nextflow profiles configured in <code>nextflow.config</code> are designed to make it so that you don't need to change the parameters. However, the pipeline offers this flexibility if it is ever called for.</p>
<h2 id="--cores">--cores<a class="headerlink" href="#--cores" title="Permanent link">&para;</a></h2>
<p>The number of cores to use during alignments and variant calling.</p>
<h2 id="--out">--out<a class="headerlink" href="#--out" title="Permanent link">&para;</a></h2>
<p>A directory in which to output results. By default it will be <code>concordance-YYYY-MM-DD</code> where YYYY-MM-DD is todays date.</p>
<h2 id="--sample_sheet">--sample_sheet<a class="headerlink" href="#--sample_sheet" title="Permanent link">&para;</a></h2>
<p>The sample sheet to use. Normally you can use the <code>sample_sheet.tsv</code> located in the base of the repo. This sample sheet is constructed usign <code>scripts/construct_sample_sheet.sh</code>.</p>
<p>When running with <code>-debug</code> the sample sheet located in <code>test_data/sample_sheet.tsv</code> will be used.</p>
<p>More information on the sample sheet and adding new sequence data on the <a href="../sample-sheets/">Sample sheet page</a> section.</p>
<h2 id="--fq_prefix">--fq_prefix<a class="headerlink" href="#--fq_prefix" title="Permanent link">&para;</a></h2>
<p>A prefix path for FASTQs defined in the sample sheet. The sample sheet designed for usage on Quest (<code>sample_sheet.tsv</code>) uses absolute paths so no FASTQ prefix is necessary. It is set to <code>null</code> by default.</p>
<h2 id="--reference">--reference<a class="headerlink" href="#--reference" title="Permanent link">&para;</a></h2>
<p>A fasta reference indexed with BWA. On Quest, the reference is available here:</p>
<pre><code>/projects/b1059/data/genomes/c_elegans/WS245/WS245.fa.gz
</code></pre>

<h2 id="--tmpdir">--tmpdir<a class="headerlink" href="#--tmpdir" title="Permanent link">&para;</a></h2>
<p>A directory for storing temporary data.</p>
<h2 id="--bamdir">--bamdir<a class="headerlink" href="#--bamdir" title="Permanent link">&para;</a></h2>
<p>A directory to output strain-level BAM files to. On Quest this is set by default to</p>
<p><code>/projects/b1059/data/alignments/WI/strain/</code></p>
<h2 id="--email">--email<a class="headerlink" href="#--email" title="Permanent link">&para;</a></h2>
<p>Set an email to get notified when the pipeline succeeds or fails.</p>
<h1 id="output">Output<a class="headerlink" href="#output" title="Permanent link">&para;</a></h1>
<h2 id="concordance">Concordance/<a class="headerlink" href="#concordance" title="Permanent link">&para;</a></h2>
<h3 id="concordancepng"><strong>concordance.png</strong><a class="headerlink" href="#concordancepng" title="Permanent link">&para;</a></h3>
<p><img alt="concordance" src="../img/concordance.png" /></p>
<p>An image showing the distribution of pairwise concordances across all strains. The cutoff is at 99.9% above which pairs are considered to be in the same isotype unless issues arise.</p>
<h3 id="concordance_above_99png"><strong>concordance_above_99.png</strong><a class="headerlink" href="#concordance_above_99png" title="Permanent link">&para;</a></h3>
<p><img alt="concordance above 99" src="../img/concordance_above_99.png" /></p>
<p>A close up view of the concordances showing more detail. </p>
<h3 id="isotype_groupstsv"><strong>isotype_groups.tsv</strong><a class="headerlink" href="#isotype_groupstsv" title="Permanent link">&para;</a></h3>
<p><strong>This is the most important output file</strong>. It illustrates the isotypes identified for each strain and identifies potential issues.</p>
<p>A file with the following structure:</p>
<table>
<thead>
<tr>
<th align="right">group</th>
<th align="left">strain</th>
<th align="left">isotype</th>
<th align="right">latitude</th>
<th align="right">longitude</th>
<th align="right">coverage</th>
<th align="right">unique_isotypes_per_group</th>
<th align="right">unique_groups_per_isotype</th>
<th align="left">strain_in_multiple_isotypes</th>
<th align="left">location_issue</th>
<th align="left">strain_conflict</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">1</td>
<td align="left">AB1</td>
<td align="left">AB1</td>
<td align="right">-34.93</td>
<td align="right">138.59</td>
<td align="right">69.4687</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr>
<td align="right">112</td>
<td align="left">AB4</td>
<td align="left">CB4858</td>
<td align="right">-34.93</td>
<td align="right">138.59</td>
<td align="right">158.358</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr>
<td align="right">112</td>
<td align="left">ECA251</td>
<td align="left">CB4858</td>
<td align="right">34.1</td>
<td align="right">-118.1</td>
<td align="right">73.5843</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr>
<td align="right">112</td>
<td align="left">JU1960</td>
<td align="left">CB4858</td>
<td align="right">34.1897</td>
<td align="right">-118.131</td>
<td align="right">55.0373</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr>
<td align="right">175</td>
<td align="left">BRC20067</td>
<td align="left">BRC20067</td>
<td align="right">24.073</td>
<td align="right">121.17</td>
<td align="right">33.5934</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr>
<td align="right">175</td>
<td align="left">BRC20113</td>
<td align="left">BRC20067</td>
<td align="right">24.1242</td>
<td align="right">121.283</td>
<td align="right">38.9916</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr>
<td align="right">186</td>
<td align="left">BRC20231</td>
<td align="left">MY23</td>
<td align="right">23.5415</td>
<td align="right">120.908</td>
<td align="right">44.1452</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr>
<td align="right">186</td>
<td align="left">MY23</td>
<td align="left">MY23</td>
<td align="right">51.96</td>
<td align="right">7.53</td>
<td align="right">132.185</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>group</strong> - A number used to group strains (in each row) into an isotype automatically. This number should be unique with the isotype column (e.g. 1--&gt; AB1, 112 --&gt; CB4858, BRC20067 --&gt; 175). The number can change between analyses.</li>
<li><strong>strain</strong> - the strain</li>
<li><strong>isotype</strong> - the currently assigned isotype for a strain taken from the <code>WI Strain Info</code> spreadsheet. When new strains are added this is blank. </li>
<li><strong>latitude</strong></li>
<li><strong>longitude</strong></li>
<li><strong>coverage</strong> - Depth of coverage for strain.</li>
<li><strong>unique_isotypes_per_group</strong> - Number of unique isotypes when grouping by the group column. This should be 1. If it is more than 1, it indicates that multiple isotypes were assigned to a grouping and that a previously assigned isotype is now being called into question.</li>
<li><strong>unique_groups_per_isotype</strong> Number of unique groups assigned to an isotype. This should be 1. If it is higher than 1, it indicates that a strain is concordant with strains in two different isotypes (including blanks). If it is equal to 2 and contains blanks in the isotype column it likely means that an isotype should be assigned to that strain.</li>
<li><strong>strain_in_multiple_isotypes</strong> - Indicates that a strain is falling into multiple isotypes (a problem!).</li>
<li><strong>location_issue</strong> - Indicates a location issue. This occurs when strains fall into an isotype but are located far away from one another. Some are known issues and can be ignored.</li>
<li><strong>strain_conflict</strong> - <code>TRUE</code> if any issue is present that should be investigated.</li>
</ul>
<h3 id="gtcheck">gtcheck<a class="headerlink" href="#gtcheck" title="Permanent link">&para;</a></h3>
<p>File produced using <code>bcftools gtcheck</code>; Raw genotype differences between strains.</p>
<h3 id="isotype_counttxt">isotype_count.txt<a class="headerlink" href="#isotype_counttxt" title="Permanent link">&para;</a></h3>
<p>Gives a count of the number of isotypes identified.</p>
<h3 id="heterozygosity">Heterozygosity<a class="headerlink" href="#heterozygosity" title="Permanent link">&para;</a></h3>
<p>Number of heterozygous sites/strain. Can be an indicator of mixed samples or other issues.</p>
<h3 id="fq_concordancetsv">fq_concordance.tsv<a class="headerlink" href="#fq_concordancetsv" title="Permanent link">&para;</a></h3>
<p>Intra-strain FASTQ-pair concordances. The format is:</p>
<h3 id="concordancepairwise_directory">concordance/pairwise/ (directory)<a class="headerlink" href="#concordancepairwise_directory" title="Permanent link">&para;</a></h3>
<p>Contains images showing locations where regional discordance occurs among strains classified as being the isotype. You must look through all these images to ensure there are no strains being grouped that have regions with significant differences (&gt; 2%). The image below illustrates an example of this. ED3049 and ED3046 are highly similar (&gt; 99.9%). However, they differ in a region on the right arm of chromosome II. We believe this was enough reason to consider them separate isotypes.</p>
<p><img alt="pairwise example" src="../img/194.ED3049.ED3046_ED3049.png" /></p>
<h2 id="duplicates">Duplicates/<a class="headerlink" href="#duplicates" title="Permanent link">&para;</a></h2>
<h3 id="bam_duplicatestsv">bam_duplicates.tsv<a class="headerlink" href="#bam_duplicatestsv" title="Permanent link">&para;</a></h3>
<p>Summary of duplicate reads (determined by picard).</p>
<h2 id="fq">fq/<a class="headerlink" href="#fq" title="Permanent link">&para;</a></h2>
<p>The following files are output in the fastq directory</p>
<pre><code>fq_bam_idxstats.tsv   # Stats generated with `samtools idxstats`
fq_bam_stats.tsv      # Stats generated with `samtools stats`
fq_coverage.full.tsv  # Detailed coverage numbers
fq_coverage.tsv       # Summary coverage of individual fastqs.
</code></pre>

<h2 id="strain">strain/<a class="headerlink" href="#strain" title="Permanent link">&para;</a></h2>
<p>The following files are output in the strain directory</p>
<pre><code>strain_bam_idxstats.tsv   # Stats generated with `samtools idxstats`
strain_bam_stats.tsv      # Stats generated with `samtools stats`
strain_coverage.full.tsv  # Detailed coverage numbers
strain_coverage.tsv       # Summary coverage for strains.
</code></pre>

<h2 id="variation">variation/<a class="headerlink" href="#variation" title="Permanent link">&para;</a></h2>
<h3 id="sitelisttsvgztbi">sitelist.tsv.gz(+tbi)<a class="headerlink" href="#sitelisttsvgztbi" title="Permanent link">&para;</a></h3>
<p>The union-variant sitelist from all strains.</p>
<h3 id="union_vcftxt">union_vcf.txt<a class="headerlink" href="#union_vcftxt" title="Permanent link">&para;</a></h3>
<p>Locations of the union VCFs.</p>
<h3 id="mergedrawvcfgzcsi">merged.raw.vcf.gz(+csi)<a class="headerlink" href="#mergedrawvcfgzcsi" title="Permanent link">&para;</a></h3>
<p>The raw VCF. The following filters are applied before calculating concordance:</p>
<pre><code>    min_depth&gt;3        # Minimum Depth
    qual&gt;30            # Quality (VCF=QUAL)
    mq&gt;40              # Mapping Quality
    dv_dp=0.5          # DV/DP &gt; 0.5 (high-quality allelic ALT bases over total depth)
    max_missing&lt;0.05   # Max number of missing sites cannot exceed 5%
</code></pre>

<h3 id="concordancevcfgzcsi">concordance.vcf.gz(+csi)<a class="headerlink" href="#concordancevcfgzcsi" title="Permanent link">&para;</a></h3>
<p>Filtered VCF, filtered for true SNPs (no monomorphic sites)</p>
<h3 id="concordancestats">concordance.stats<a class="headerlink" href="#concordancestats" title="Permanent link">&para;</a></h3>
<p>Stats from concordance vcf. Contains the number of SNPs.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../pipeline-wi/" class="btn btn-neutral float-right" title="WI">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../pipeline-alignment/" class="btn btn-neutral" title="WI-Alignment"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/Andersenlab/dry-guide/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../pipeline-alignment/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../pipeline-wi/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
